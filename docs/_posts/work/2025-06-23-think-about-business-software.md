---
title:  "think about a business software"
date:   2025-06-23 23:07:00 +0800
last_modified_at: 2025-06-23 23:08:00 +0800
categories: work
tags: process
---

# think about one business process  

商业化的软件, 尤其是大型的(电信级)的商业化软件, 必定跟普通的工具小程序有不同, 关于此在工作经历上做了一些记录和思考.  
比如系统分为A(windows控制端), B后台系统(受控端, 数据库, 日志管理, 业务数据汇总)

## 1.框架  
大型软件很可能基于一套成熟的框架, 以实现架构代码和业务代码分离, 同时便于分工维护.  
框架代码有可能是开源的, 有可能是企业内部平台部门开发的, 也可能是买的国外版权的.  
main函数不包含任务业务代码, 只是为了启动进程, 创建线程, 维持框架运行  

## 2.跨平台封装  
c语言和C++程序没有像java一样的跨平台中间件(jvm), 若要实现平台分离则中间大概率有一层封装, 以实现跨系统  
比如:  
 - 对安全函数的封装(linux下没有专门的c安全函数)
 - 对md5和sha256的封装(及密钥加解密)
 - 对SIP/SDP/RTP/MRCP通用协议的解析和封装  
 - 对各种时间操作的封装
 - 对CPU TICK的封装  
 - 对音视频编解码的封装(专门的动态库)

## 3. 部署  
商业化的软件,涉及的机器数量很可能不是一台. 这就涉及到软件的分发和部署.  
比如一台机器作为后台, 负责软件的备份, 分发, 数据库, 日志和业务数据的管理.  
比如一台机器作为主机, 运行业务软件.  
这里有个点是为了增加主机程序的分发速度, 主机程序在分发时,是处于压缩状态的  

## 4.守护  
商业化的软件, 大多是有守护进程的, 以便主程序在故障时能快速恢复  
首都程序可能是单独的进程(watch dog), 也可能是单独的线程(业务线程是fork的子进程), 还可能是子进程通过excel转换  

## 5.托管  
商业化的软件, 为了安全合规, 很可能无法使用root权限或使用有限的root权限.  
比如运行安装时提供root密码, 运行和维护就只能使用单独的用户和属组  
有些程序采用root进程启动, 然后托管给专属用户组.有些是通过sudo使用有限的root权限  

## 6.日志  
商业化的软件, 必定有模块化的日志管理系统  
比如正常写日志到本地磁盘,可能会有io问题, 或者日志归集问题.  
这时候会有专门的日志服务器, 用来采集各个机器上的日志, 或者日志输出到集群  

## 7.主备  
网络上的主备, 比如bond网卡, 比如vip, 比如浮动ip  
进程上的主备, 比如pool模式, 比如主备模式  
系统上的主备, 比如集群  

## 8.防火墙和通信矩阵  
软件通信的协议和端口要在产品文档中说明, 并申请防火墙放通  
通信矩阵包含设计的所有ip和端口, 或者二层网络报文的特征(若设计二层私有协议)  

## 9.内核规则或模块  
为了提高性能, 需要内核规则(如tc filter)或者内核模块配合, 使用网络报文的高效处理  
